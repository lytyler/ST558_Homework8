[
  {
    "objectID": "Homework8.html",
    "href": "Homework8.html",
    "title": "ST558 Homework 8",
    "section": "",
    "text": "The Seoul Bike Sharing Demand data set contains information about hourly bike rentals in the Seoul Bike Sharing System for the year from 12/01/2017 to 11/30/2017. The data set also contains corresponding weather, date, time, season, and holiday information. The data is housed at the IC Irvine Machine Learning Repository. See more information about the data here: https://archive.ics.uci.edu/dataset/560/seoul+bike+sharing+demand\nThe purpose of this analysis is to explore the data and fit a multiple Linear Regressions (MLR) model.\n\n\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(lubridate)\nlibrary(tidymodels)\n\nWarning: package 'tidymodels' was built under R version 4.5.2\n\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.4.1 ──\n✔ broom        1.0.9     ✔ rsample      1.3.1\n✔ dials        1.4.2     ✔ tailor       0.1.0\n✔ infer        1.0.9     ✔ tune         2.0.1\n✔ modeldata    1.5.1     ✔ workflows    1.3.0\n✔ parsnip      1.3.3     ✔ workflowsets 1.1.1\n✔ recipes      1.3.1     ✔ yardstick    1.3.2\n\n\nWarning: package 'dials' was built under R version 4.5.2\n\n\nWarning: package 'infer' was built under R version 4.5.2\n\n\nWarning: package 'modeldata' was built under R version 4.5.2\n\n\nWarning: package 'parsnip' was built under R version 4.5.2\n\n\nWarning: package 'recipes' was built under R version 4.5.2\n\n\nWarning: package 'rsample' was built under R version 4.5.2\n\n\nWarning: package 'tailor' was built under R version 4.5.2\n\n\nWarning: package 'tune' was built under R version 4.5.2\n\n\nWarning: package 'workflows' was built under R version 4.5.2\n\n\nWarning: package 'workflowsets' was built under R version 4.5.2\n\n\nWarning: package 'yardstick' was built under R version 4.5.2\n\n\n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n\nlibrary(rsample)"
  },
  {
    "objectID": "Homework8.html#data-seoul-bike-sharing-demand",
    "href": "Homework8.html#data-seoul-bike-sharing-demand",
    "title": "ST558 Homework 8",
    "section": "",
    "text": "The Seoul Bike Sharing Demand data set contains information about hourly bike rentals in the Seoul Bike Sharing System for the year from 12/01/2017 to 11/30/2017. The data set also contains corresponding weather, date, time, season, and holiday information. The data is housed at the IC Irvine Machine Learning Repository. See more information about the data here: https://archive.ics.uci.edu/dataset/560/seoul+bike+sharing+demand\nThe purpose of this analysis is to explore the data and fit a multiple Linear Regressions (MLR) model.\n\n\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(lubridate)\nlibrary(tidymodels)\n\nWarning: package 'tidymodels' was built under R version 4.5.2\n\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.4.1 ──\n✔ broom        1.0.9     ✔ rsample      1.3.1\n✔ dials        1.4.2     ✔ tailor       0.1.0\n✔ infer        1.0.9     ✔ tune         2.0.1\n✔ modeldata    1.5.1     ✔ workflows    1.3.0\n✔ parsnip      1.3.3     ✔ workflowsets 1.1.1\n✔ recipes      1.3.1     ✔ yardstick    1.3.2\n\n\nWarning: package 'dials' was built under R version 4.5.2\n\n\nWarning: package 'infer' was built under R version 4.5.2\n\n\nWarning: package 'modeldata' was built under R version 4.5.2\n\n\nWarning: package 'parsnip' was built under R version 4.5.2\n\n\nWarning: package 'recipes' was built under R version 4.5.2\n\n\nWarning: package 'rsample' was built under R version 4.5.2\n\n\nWarning: package 'tailor' was built under R version 4.5.2\n\n\nWarning: package 'tune' was built under R version 4.5.2\n\n\nWarning: package 'workflows' was built under R version 4.5.2\n\n\nWarning: package 'workflowsets' was built under R version 4.5.2\n\n\nWarning: package 'yardstick' was built under R version 4.5.2\n\n\n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n\nlibrary(rsample)"
  },
  {
    "objectID": "Homework8.html#eda-checking-and-exploring-data",
    "href": "Homework8.html#eda-checking-and-exploring-data",
    "title": "ST558 Homework 8",
    "section": "EDA: Checking and Exploring Data",
    "text": "EDA: Checking and Exploring Data\n\nRead in data:\n\nbike_data &lt;- read_csv(\"https://www4.stat.ncsu.edu/~online/datasets/SeoulBikeData.csv\", locale = locale(encoding = \"latin1\"))\n\nRows: 8760 Columns: 14\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): Date, Seasons, Holiday, Functioning Day\ndbl (10): Rented Bike Count, Hour, Temperature(°C), Humidity(%), Wind speed ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nhead(bike_data) #take a look\n\n# A tibble: 6 × 14\n  Date       `Rented Bike Count`  Hour `Temperature(°C)` `Humidity(%)`\n  &lt;chr&gt;                    &lt;dbl&gt; &lt;dbl&gt;             &lt;dbl&gt;         &lt;dbl&gt;\n1 01/12/2017                 254     0              -5.2            37\n2 01/12/2017                 204     1              -5.5            38\n3 01/12/2017                 173     2              -6              39\n4 01/12/2017                 107     3              -6.2            40\n5 01/12/2017                  78     4              -6              36\n6 01/12/2017                 100     5              -6.4            37\n# ℹ 9 more variables: `Wind speed (m/s)` &lt;dbl&gt;, `Visibility (10m)` &lt;dbl&gt;,\n#   `Dew point temperature(°C)` &lt;dbl&gt;, `Solar Radiation (MJ/m2)` &lt;dbl&gt;,\n#   `Rainfall(mm)` &lt;dbl&gt;, `Snowfall (cm)` &lt;dbl&gt;, Seasons &lt;chr&gt;, Holiday &lt;chr&gt;,\n#   `Functioning Day` &lt;chr&gt;\n\n\n\n\nCheck for missing values:\n\nsum(is.na(bike_data))\n\n[1] 0\n\n\nThere are no missing values in the data.\n\n\nCheck columns for data type and reasonable values:\n\nsummary(bike_data)\n\n     Date           Rented Bike Count      Hour       Temperature(°C) \n Length:8760        Min.   :   0.0    Min.   : 0.00   Min.   :-17.80  \n Class :character   1st Qu.: 191.0    1st Qu.: 5.75   1st Qu.:  3.50  \n Mode  :character   Median : 504.5    Median :11.50   Median : 13.70  \n                    Mean   : 704.6    Mean   :11.50   Mean   : 12.88  \n                    3rd Qu.:1065.2    3rd Qu.:17.25   3rd Qu.: 22.50  \n                    Max.   :3556.0    Max.   :23.00   Max.   : 39.40  \n  Humidity(%)    Wind speed (m/s) Visibility (10m) Dew point temperature(°C)\n Min.   : 0.00   Min.   :0.000    Min.   :  27     Min.   :-30.600          \n 1st Qu.:42.00   1st Qu.:0.900    1st Qu.: 940     1st Qu.: -4.700          \n Median :57.00   Median :1.500    Median :1698     Median :  5.100          \n Mean   :58.23   Mean   :1.725    Mean   :1437     Mean   :  4.074          \n 3rd Qu.:74.00   3rd Qu.:2.300    3rd Qu.:2000     3rd Qu.: 14.800          \n Max.   :98.00   Max.   :7.400    Max.   :2000     Max.   : 27.200          \n Solar Radiation (MJ/m2)  Rainfall(mm)     Snowfall (cm)       Seasons         \n Min.   :0.0000          Min.   : 0.0000   Min.   :0.00000   Length:8760       \n 1st Qu.:0.0000          1st Qu.: 0.0000   1st Qu.:0.00000   Class :character  \n Median :0.0100          Median : 0.0000   Median :0.00000   Mode  :character  \n Mean   :0.5691          Mean   : 0.1487   Mean   :0.07507                     \n 3rd Qu.:0.9300          3rd Qu.: 0.0000   3rd Qu.:0.00000                     \n Max.   :3.5200          Max.   :35.0000   Max.   :8.80000                     \n   Holiday          Functioning Day   \n Length:8760        Length:8760       \n Class :character   Class :character  \n Mode  :character   Mode  :character  \n                                      \n                                      \n                                      \n\n\nThe date, seasons, holiday, and functioning day variables are all formatted as character data. The rest of the values are numeric, and the basic summary statistics seem reasonable for the numeric variables.\n\n\nRename variables:\nRename the variables to make them easier to work with.\n\nnames(bike_data) &lt;- c(\"date\", \"bike_count\", \"hour\", \"temp\", \"hum\", \"wind_speed\", \"vis\", \"dew_pt\", \"sol_rad\", \"rainfall\", \"snowfall\", \"seasons\", \"holiday\", \"func_day\")\n\n\n\nConvert data types as needed:\nConvert date column to date data-type and seasons, holiday, and functional day columns to factors.\n\nbike_data &lt;- bike_data |&gt;\n  mutate(date = dmy(date),\n         seasons = as.factor(seasons),\n         holiday = as.factor(holiday),\n         func_day = as.factor(func_day))\n\n\n\nCheck columns for data type and reasonable values again after transfroming data:\n\nsummary(bike_data)\n\n      date              bike_count          hour            temp       \n Min.   :2017-12-01   Min.   :   0.0   Min.   : 0.00   Min.   :-17.80  \n 1st Qu.:2018-03-02   1st Qu.: 191.0   1st Qu.: 5.75   1st Qu.:  3.50  \n Median :2018-06-01   Median : 504.5   Median :11.50   Median : 13.70  \n Mean   :2018-06-01   Mean   : 704.6   Mean   :11.50   Mean   : 12.88  \n 3rd Qu.:2018-08-31   3rd Qu.:1065.2   3rd Qu.:17.25   3rd Qu.: 22.50  \n Max.   :2018-11-30   Max.   :3556.0   Max.   :23.00   Max.   : 39.40  \n      hum          wind_speed         vis           dew_pt       \n Min.   : 0.00   Min.   :0.000   Min.   :  27   Min.   :-30.600  \n 1st Qu.:42.00   1st Qu.:0.900   1st Qu.: 940   1st Qu.: -4.700  \n Median :57.00   Median :1.500   Median :1698   Median :  5.100  \n Mean   :58.23   Mean   :1.725   Mean   :1437   Mean   :  4.074  \n 3rd Qu.:74.00   3rd Qu.:2.300   3rd Qu.:2000   3rd Qu.: 14.800  \n Max.   :98.00   Max.   :7.400   Max.   :2000   Max.   : 27.200  \n    sol_rad          rainfall          snowfall         seasons    \n Min.   :0.0000   Min.   : 0.0000   Min.   :0.00000   Autumn:2184  \n 1st Qu.:0.0000   1st Qu.: 0.0000   1st Qu.:0.00000   Spring:2208  \n Median :0.0100   Median : 0.0000   Median :0.00000   Summer:2208  \n Mean   :0.5691   Mean   : 0.1487   Mean   :0.07507   Winter:2160  \n 3rd Qu.:0.9300   3rd Qu.: 0.0000   3rd Qu.:0.00000                \n Max.   :3.5200   Max.   :35.0000   Max.   :8.80000                \n       holiday     func_day  \n Holiday   : 432   No : 295  \n No Holiday:8328   Yes:8465  \n                             \n                             \n                             \n                             \n\n\nNumeric variables already checked out and have not changed, but now we can see that the data column (as date data) and the seasons, holiday, and functional day columns (as factors) also look reasonable.\n\n\nCreate summary statistics:\nFocus on summary statistics for hourly bike rental data (bike_count).\n\n#overall summary of hourly bike rental counts\nbike_data |&gt;\n  summarize (\"min\" = min(bike_count), \"mean\" = mean(bike_count), \"median\" = median(bike_count), \"max\" = max(bike_count), \"sd\" = sd(bike_count))\n\n# A tibble: 1 × 5\n    min  mean median   max    sd\n  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1     0  705.   504.  3556  645.\n\n\nThe median hourly bike rental count is less than the mean, indicating a right-skewed data set. The standard deviation is between the median and the mean in value, which seems like a lot of variability.\n\n#grouped by seasons\nbike_data |&gt;\n  group_by(seasons) |&gt;\n  summarize (\"min\" = min(bike_count), \"mean\" = mean(bike_count), \"median\" = median(bike_count), \"max\" = max(bike_count), \"sd\" = sd(bike_count))\n\n# A tibble: 4 × 6\n  seasons   min  mean median   max    sd\n  &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Autumn      0  820.   764.  3298  651.\n2 Spring      0  730.   583   3251  622.\n3 Summer      9 1034.   906.  3556  690.\n4 Winter      3  226.   203    937  150.\n\n\nSummer had the highest mean, median, and max hourly bike rentals, while winter has the lowest.\n\n#grouped by holiday or not\nbike_data |&gt;\n  group_by(holiday) |&gt;\n  summarize (\"min\" = min(bike_count), \"mean\" = mean(bike_count), \"median\" = median(bike_count), \"max\" = max(bike_count), \"sd\" = sd(bike_count))\n\n# A tibble: 2 × 6\n  holiday      min  mean median   max    sd\n  &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Holiday        0  500.   240   2400  571.\n2 No Holiday     0  715.   524.  3556  647.\n\n\nValues are higher for non-holidays.\n\n#grouped by functioning day or not\nbike_data |&gt;\n  group_by(func_day) |&gt;\n  summarize (\"min\" = min(bike_count), \"mean\" = mean(bike_count), \"median\" = median(bike_count), \"max\" = max(bike_count), \"sd\" = sd(bike_count))\n\n# A tibble: 2 × 6\n  func_day   min  mean median   max    sd\n  &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 No           0    0       0     0    0 \n2 Yes          2  729.    542  3556  642.\n\n\nWe see that there were no bike rentals recorded for non-functional days, so we will drop these values from the data set. That whole group is basically “NA.” The bike sharing system seems to have been closed or otherwise unavailable.\n\n\nRe-create previous summaries without non-functional days, and add correlation:\n\n#overall summary of hourly bike rental counts\nbike_data |&gt;\n  filter(func_day == \"Yes\") |&gt;\n  summarize (\"min\" = min(bike_count), \"mean\" = mean(bike_count), \"median\" = median(bike_count), \"max\" = max(bike_count), \"sd\" = sd(bike_count))\n\n# A tibble: 1 × 5\n    min  mean median   max    sd\n  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1     2  729.    542  3556  642.\n\n\nThe minimum, mean, and median all shifted up a bit without the non-functional days, and the standard deviation decreased a bit. Overall the results are similar.\n\n#grouped by seasons\nbike_data |&gt;\n  filter(func_day == \"Yes\") |&gt;\n  group_by(seasons) |&gt;\n  summarize (\"min\" = min(bike_count), \"mean\" = mean(bike_count), \"median\" = median(bike_count), \"max\" = max(bike_count), \"sd\" = sd(bike_count))\n\n# A tibble: 4 × 6\n  seasons   min  mean median   max    sd\n  &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Autumn      2  924.   856   3298  618.\n2 Spring      2  746.   599   3251  619.\n3 Summer      9 1034.   906.  3556  690.\n4 Winter      3  226.   203    937  150.\n\n\nHourly bike rentals are highest in summer and lowest in winter.\n\n#grouped by holiday or not\nbike_data |&gt;\n  filter(func_day == \"Yes\") |&gt;\n  group_by(holiday) |&gt;\n  summarize (\"min\" = min(bike_count), \"mean\" = mean(bike_count), \"median\" = median(bike_count), \"max\" = max(bike_count), \"sd\" = sd(bike_count))\n\n# A tibble: 2 × 6\n  holiday      min  mean median   max    sd\n  &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Holiday        3  529.    259  2400  574.\n2 No Holiday     2  739.    561  3556  644.\n\n\nAgain, there are more bike rentals on non-holidays than on holidays.\n\n#correlation matrix\nbike_data |&gt;\n  filter(func_day == \"Yes\") |&gt;\n  select(where(is.numeric)) |&gt;\n  cor()\n\n           bike_count         hour        temp        hum   wind_speed\nbike_count  1.0000000  0.425255882  0.56274017 -0.2019727  0.125021946\nhour        0.4252559  1.000000000  0.12274182 -0.2359372  0.287779819\ntemp        0.5627402  0.122741816  1.00000000  0.1664252 -0.038480848\nhum        -0.2019727 -0.235937180  0.16642522  1.0000000 -0.337352380\nwind_speed  0.1250219  0.287779819 -0.03848085 -0.3373524  1.000000000\nvis         0.2123228  0.103869318  0.02826206 -0.5485418  0.180427649\ndew_pt      0.4002628  0.004691479  0.91446695  0.5394024 -0.177170126\nsol_rad     0.2738616  0.144658482  0.35484355 -0.4572727  0.326221868\nrainfall   -0.1286261  0.014344645  0.05214889  0.2369169 -0.024931327\nsnowfall   -0.1516108 -0.022082499 -0.21774581  0.1101265 -0.003789344\n                   vis       dew_pt     sol_rad     rainfall     snowfall\nbike_count  0.21232278  0.400262829  0.27386155 -0.128626093 -0.151610753\nhour        0.10386932  0.004691479  0.14465848  0.014344645 -0.022082499\ntemp        0.02826206  0.914466952  0.35484355  0.052148891 -0.217745811\nhum        -0.54854183  0.539402446 -0.45727269  0.236916912  0.110126502\nwind_speed  0.18042765 -0.177170126  0.32622187 -0.024931327 -0.003789344\nvis         1.00000000 -0.182586445  0.15304614 -0.170351798 -0.122859731\ndew_pt     -0.18258645  1.000000000  0.09852498  0.126812453 -0.149759793\nsol_rad     0.15304614  0.098524979  1.00000000 -0.074157271 -0.073379874\nrainfall   -0.17035180  0.126812453 -0.07415727  1.000000000  0.008604092\nsnowfall   -0.12285973 -0.149759793 -0.07337987  0.008604092  1.000000000\n\n\nFocusing on the first set of correlation coefficients (between hourly bike rentals (bike_count) and the other numeric variables), we don’t see strong correlations, but the strongest are with temperature (0.56), hour (0.43) and dew point (0.40).\n\n\nSimplify Dataset from Hourly to Daily\nFor the purpose of this analysis, we will simplify the hourly bike rental data set into a daily bike rental data set. Variables will be averaged or summed across the day or just carried over, as appropriate for each variable. Non-functional days are dropped.\n\ndaily_bike_data &lt;- bike_data|&gt;\n  filter(func_day == \"Yes\") |&gt;\n  group_by(date, seasons, holiday) |&gt;\n  summarize(bike_count = sum(bike_count), \n            rainfall = sum(rainfall), \n            snowfall = sum(snowfall), \n            temp = mean(temp),\n            hum = mean(hum),\n            wind_speed = mean(wind_speed),\n            vis = mean(vis),\n            dew_pt = mean(dew_pt),\n            sol_rad = mean(sol_rad)) |&gt;\n  ungroup()\n\n`summarise()` has grouped output by 'date', 'seasons'. You can override using\nthe `.groups` argument.\n\nhead(daily_bike_data) #take a look\n\n# A tibble: 6 × 12\n  date       seasons holiday    bike_count rainfall snowfall    temp   hum\n  &lt;date&gt;     &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;\n1 2017-12-01 Winter  No Holiday       9539      0        0   -2.45    45.9\n2 2017-12-02 Winter  No Holiday       8523      0        0    1.32    62.0\n3 2017-12-03 Winter  No Holiday       7222      4        0    4.88    81.5\n4 2017-12-04 Winter  No Holiday       8729      0.1      0   -0.304   52.5\n5 2017-12-05 Winter  No Holiday       8307      0        0   -4.46    36.4\n6 2017-12-06 Winter  No Holiday       6669      1.3      8.6  0.0458  70.8\n# ℹ 4 more variables: wind_speed &lt;dbl&gt;, vis &lt;dbl&gt;, dew_pt &lt;dbl&gt;, sol_rad &lt;dbl&gt;\n\n\n\n\nCreate Summary Statistics and Plots for Daily Data Set\nFocus on daily bike counts.\n\n#overall summary of daily bike rentals\ndaily_bike_data |&gt;\n  summarize (\"min\" = min(bike_count), \"mean\" = mean(bike_count), \"median\" = median(bike_count), \"max\" = max(bike_count), \"sd\" = sd(bike_count))\n\n# A tibble: 1 × 5\n    min   mean median   max    sd\n  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1   977 17485.  18563 36149 9937.\n\n\nUnlike the hourly summaries, the daily bike rental mean is lower than the median and the standard deviation is about half the median/mean value.\n\n#grouped by seasons\ndaily_bike_data |&gt;\n  group_by(seasons) |&gt;\n  summarize (\"min\" = min(bike_count), \"mean\" = mean(bike_count), \"median\" = median(bike_count), \"max\" = max(bike_count), \"sd\" = sd(bike_count))\n\n# A tibble: 4 × 6\n  seasons   min   mean median   max    sd\n  &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Autumn   1721 22099. 23350  31809 6711.\n2 Spring    977 17910. 17590  31681 8357.\n3 Summer   3231 24818. 25572. 36149 7297.\n4 Winter   2014  5413.  5498   9539 1808.\n\n\nThe summary statistics are generally much lower for winter, with the exception of minimum value. Summer has the highest values, followed by autumn.\n\n#grouped by holiday or not\ndaily_bike_data |&gt;\n  group_by(holiday) |&gt;\n  summarize (\"min\" = min(bike_count), \"mean\" = mean(bike_count), \"median\" = median(bike_count), \"max\" = max(bike_count), \"sd\" = sd(bike_count))\n\n# A tibble: 2 × 6\n  holiday      min   mean median   max     sd\n  &lt;fct&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n1 Holiday     2014 12700.  7184  30498 10504.\n2 No Holiday   977 17727. 19104. 36149  9862.\n\n\nAgain there are more daily rentals on non-holidays, although the minimum is lower.\n\n#grouped by season and holiday\ndaily_bike_data |&gt;\n  group_by(seasons, holiday) |&gt;\n  summarize (\"min\" = min(bike_count), \"mean\" = mean(bike_count), \"median\" = median(bike_count), \"max\" = max(bike_count), \"sd\" = sd(bike_count))\n\n`summarise()` has grouped output by 'seasons'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 8 × 7\n# Groups:   seasons [4]\n  seasons holiday      min   mean median   max     sd\n  &lt;fct&gt;   &lt;fct&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n1 Autumn  Holiday    17259 22754. 21705  30349  5642.\n2 Autumn  No Holiday  1721 22065. 23472  31809  6792.\n3 Spring  Holiday     5132 15247. 13790  26820 10917.\n4 Spring  No Holiday   977 18002. 17730  31681  8322.\n5 Summer  Holiday    18565 24532. 24532. 30498  8438.\n6 Summer  No Holiday  3231 24824. 25572. 36149  7324.\n7 Winter  Holiday     2014  3759   3454.  7184  1561.\n8 Winter  No Holiday  2487  5574.  5609   9539  1757.\n\n\nBelow is a correlation matrix of all numeric variables in the data set:\n\n#correlation matrix\ndaily_bike_data |&gt;\n  select(where(is.numeric)) |&gt;\n  cor()\n\n            bike_count    rainfall    snowfall         temp         hum\nbike_count  1.00000000 -0.23910905 -0.26529110  0.753076732  0.03588697\nrainfall   -0.23910905  1.00000000 -0.02313404  0.144517274  0.52864263\nsnowfall   -0.26529110 -0.02313404  1.00000000 -0.266963662  0.06539191\ntemp        0.75307673  0.14451727 -0.26696366  1.000000000  0.40416749\nhum         0.03588697  0.52864263  0.06539191  0.404167486  1.00000000\nwind_speed -0.19288142 -0.10167578  0.02088156 -0.260721792 -0.23425778\nvis         0.16599375 -0.22199387 -0.10188902  0.002336683 -0.55917733\ndew_pt      0.65047655  0.26456621 -0.20955286  0.962796255  0.63204729\nsol_rad     0.73589290 -0.32270413 -0.23343056  0.550274301 -0.27444967\n            wind_speed          vis     dew_pt     sol_rad\nbike_count -0.19288142  0.165993749  0.6504765  0.73589290\nrainfall   -0.10167578 -0.221993866  0.2645662 -0.32270413\nsnowfall    0.02088156 -0.101889019 -0.2095529 -0.23343056\ntemp       -0.26072179  0.002336683  0.9627963  0.55027430\nhum        -0.23425778 -0.559177334  0.6320473 -0.27444967\nwind_speed  1.00000000  0.206022636 -0.2877032  0.09612635\nvis         0.20602264  1.000000000 -0.1535516  0.27139591\ndew_pt     -0.28770322 -0.153551591  1.0000000  0.38315713\nsol_rad     0.09612635  0.271395906  0.3831571  1.00000000\n\n\nFocusing on the first column bike_data, we can see that the correlation coefficients are higher for the daily bike counts than for the hourly. We see the strongest correlations to temperature (0.75), solar radiation (0.73), and dew point (0.65).\nLet’s look at some plots of the daily bike rentals:\n\n#density curves of daily bike rentals grouped by seasons\nggplot(daily_bike_data, aes(x = bike_count, fill = seasons)) +\n  geom_density(alpha = 0.5) +\n  labs(x = \"Daily Bike Rentals\", y = \"Density\", title = \"Plot: Smoothed Density Curves for Bike Rentals by Season\")\n\n\n\n\n\n\n\n\nWinter is very different from the other seasons.\n\n#density curves of daily bike rentals grouped by holiday/non-holiday\nggplot(daily_bike_data, aes(x = bike_count, fill = holiday)) +\n  geom_density(alpha = 0.5) +\n  labs(x = \"Daily Bike Rentals\", y = \"Density\", title = \"Plot: Smoothed Density Curves for Bike Rentals, Holiday vs. Non-Holiday\")\n\n\n\n\n\n\n\n\nNon-holidays are bi-modal, with the lower peak corresponding to the uni-modal peak for holidays.\n\n#box plot of daily bike rentals grouped by season\nggplot(daily_bike_data, aes(x = seasons, y = bike_count, fill = seasons)) +\n  geom_boxplot() +\n  labs(x = \"Seasons\", y = \"Daily Bile Rentals\", title = \"Box Plot: Bike Rentals by Season\")\n\n\n\n\n\n\n\n\nWinter is visibly very different.\n\n#box plot of daily bike rentals grouped by holiday/non-holiday\nggplot(daily_bike_data, aes(x = holiday, y = bike_count, fill = holiday)) +\n  geom_boxplot() +\n  labs(x = \"Holiday/Non-Holiday\", y = \"Daily Bike Rentals\", title = \"Box Plot: Bike Rentals by Holiday/Non-Holiday\")\n\n\n\n\n\n\n\n\n\n#scatter plot of daily bike rentals vs. temperature, grouped by seasons\nggplot(daily_bike_data, aes(x = temp, y = bike_count, color = seasons)) +\n  geom_point() +\n  geom_smooth(method = \"lm\") +\n  labs(x = \"Temperature (C)\", y = \"Count of Daily Bike Rentals\",\n       title = \"Scatter Plot\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nThere are more bike rentals with increasing temperature, except for summer when the relationship inverts.\n\n#scatter plot of daily bike rentals vs rainfall, grouped by seasons\nggplot(daily_bike_data, aes(x = rainfall, y = bike_count, color = seasons)) +\n  geom_point() +\n  geom_smooth(method = \"lm\") +\n  labs(x = \"Rainfall (mm)\", y = \"Count of Daily Bike Rentals\",\n       title = \"Scatter Plot\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nThe plot shows fewer bike rentals with greater rainfall, but it is also clear that most days have no rainfall, weakening the overall correlation."
  },
  {
    "objectID": "Homework8.html#split-the-data",
    "href": "Homework8.html#split-the-data",
    "title": "ST558 Homework 8",
    "section": "Split the Data:",
    "text": "Split the Data:\nFor fitting linear regression models (LRM’s), the first step is to split the data for training the models.\nSplit the data into training and testing sets:\n\nset.seed(50)\nbike_split &lt;- initial_split(daily_bike_data, prop = 3/4, strata = seasons)\nbike_train &lt;- training(bike_split)\nbike_test &lt;- testing(bike_split)\n\nOn the training set, create a 10-fold cross validation (CV) split:\n\nset.seed(49)\nfolds &lt;- vfold_cv(bike_train, v = 10)"
  },
  {
    "objectID": "Homework8.html#fit-mlr-models",
    "href": "Homework8.html#fit-mlr-models",
    "title": "ST558 Homework 8",
    "section": "Fit MLR Models:",
    "text": "Fit MLR Models:\nStart with writing recipes:\n\nRecipe 1\nThis recipes specifies a formula that relates daily bike count to all other variables, except data. The date variable is used to determine a factor variable for weekday/weekend which is also used in the model, but the date variable itself is ignored. No interactions between variables are considered, numeric variables are standardized, and dummy variables are created for seasons, holiday, and weekend.\n\nbike_recipe1 &lt;- recipe(bike_count ~ ., data = bike_train) |&gt;\n  update_role(date, new_role = \"ID\") |&gt;\n  step_mutate(weekend = if_else((wday(date) %in% 1:5), \"No Weekend\", \"Weekend\")) |&gt;\n  step_string2factor(weekend) |&gt;\n  step_normalize(where(is.numeric)) |&gt;\n  step_dummy(seasons, holiday, weekend)\n\n\n\nRecipe 2\nThe second recipe is like the first, but additionally considers interactions between seasons and holiday, seasons and temp, and temp and rainfall.\n\nbike_recipe2 &lt;- recipe(bike_count ~ ., data = bike_train) |&gt;\n  update_role(date, new_role = \"ID\") |&gt;\n  step_mutate(weekend = if_else((wday(date) %in% 1:5), \"No Weekend\", \"Weekend\")) |&gt;\n  step_string2factor(weekend) |&gt;\n  step_normalize(where(is.numeric)) |&gt;\n  step_dummy(seasons, holiday, weekend) |&gt;\n  step_interact(terms = ~ starts_with(\"seasons\"):starts_with(\"holiday\") + starts_with(\"seasons\"):temp + temp:rainfall)\n\n\n\nRecipe 3\nThe third recipe is the same as the second, but additionally includes quadratic terms for each numerical predictor variable.\n\nbike_recipe3 &lt;- recipe(bike_count ~ ., data = bike_train) |&gt;\n  update_role(date, new_role = \"ID\") |&gt;\n  step_mutate(weekend = if_else((wday(date) %in% 1:5), \"No Weekend\", \"Weekend\")) |&gt;\n  step_string2factor(weekend) |&gt;\n  step_normalize(where(is.numeric)) |&gt;\n  step_dummy(seasons, holiday, weekend) |&gt;\n  step_interact(terms = ~ starts_with(\"seasons\"):starts_with(\"holiday\") + starts_with(\"seasons\"):temp + temp:rainfall) |&gt;\n  step_poly(rainfall,snowfall,temp,hum,wind_speed,vis,dew_pt,sol_rad)\n\nprep(training = bike_train) |&gt; bake(bike_train)\n\n\nSet Up Model\nLinear regression model with engine “lm”\n\nbike_model &lt;- linear_reg() |&gt;\n  set_engine(\"lm\")\n\n\n\nSet Up Workflows\n\nworkflow1 &lt;- workflow() |&gt;\n  add_recipe(bike_recipe1) |&gt;\n  add_model(bike_model)\n\nworkflow2 &lt;- workflow() |&gt;\n  add_recipe(bike_recipe2) |&gt;\n  add_model(bike_model)\n\nworkflow3 &lt;- workflow() |&gt;\n  add_recipe(bike_recipe3) |&gt;\n  add_model(bike_model)\n\n\n\nGenerate Model Fits\n\nfit1 &lt;- workflow1 |&gt;\n  fit_resamples(folds)\n\nfit2 &lt;- workflow2 |&gt;\n  fit_resamples(folds)\n\nfit3 &lt;- workflow3 |&gt;\n  fit_resamples(folds)\n\n\n\nCheck training set CV error on the model fits:\n\nfit1 |&gt;\n  collect_metrics()\n\n# A tibble: 2 × 6\n  .metric .estimator  mean     n std_err .config        \n  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          \n1 rmse    standard   0.431    10  0.0161 pre0_mod0_post0\n2 rsq     standard   0.817    10  0.0171 pre0_mod0_post0\n\nfit2 |&gt;\n  collect_metrics()\n\n# A tibble: 2 × 6\n  .metric .estimator  mean     n std_err .config        \n  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          \n1 rmse    standard   0.322    10  0.0184 pre0_mod0_post0\n2 rsq     standard   0.898    10  0.0123 pre0_mod0_post0\n\nfit3 |&gt;\n  collect_metrics()\n\n# A tibble: 2 × 6\n  .metric .estimator  mean     n std_err .config        \n  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          \n1 rmse    standard   0.313    10  0.0148 pre0_mod0_post0\n2 rsq     standard   0.904    10  0.0108 pre0_mod0_post0\n\n\nThe rmse gets lower with subsequent models. Fit 3 with quadratic terms had the lowest rmse. It also had the highest rsq. Fit3 is the best model based on training set CV error..\n\n\nFit “best” model (fit3) to the entire training set using the last_fit() function, find the rmse on the test set, and obtain the final model coefficinet table:\n\nbest_fit &lt;- last_fit(workflow3, bike_split)\ncollect_metrics(best_fit)\n\n# A tibble: 2 × 4\n  .metric .estimator .estimate .config        \n  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          \n1 rmse    standard       0.344 pre0_mod0_post0\n2 rsq     standard       0.881 pre0_mod0_post0\n\nextract_fit_parsnip(best_fit) |&gt;\n  tidy() |&gt;\n  print(n = 29)\n\n# A tibble: 29 × 5\n   term                                estimate std.error statistic  p.value\n   &lt;chr&gt;                                  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;\n 1 (Intercept)                         -0.0335     0.195     -0.171 8.64e- 1\n 2 seasons_Spring                       0.0611     0.286      0.214 8.31e- 1\n 3 seasons_Summer                       1.20       0.343      3.50  5.61e- 4\n 4 seasons_Winter                      -1.31       0.312     -4.18  4.08e- 5\n 5 holiday_No.Holiday                   0.348      0.179      1.95  5.23e- 2\n 6 weekend_Weekend                     -0.00741    0.0426    -0.174 8.62e- 1\n 7 seasons_Spring_x_holiday_No.Holiday -0.530      0.288     -1.84  6.71e- 2\n 8 seasons_Summer_x_holiday_No.Holiday -0.0647     0.276     -0.234 8.15e- 1\n 9 seasons_Winter_x_holiday_No.Holiday  0.122      0.223      0.546 5.85e- 1\n10 seasons_Spring_x_temp                0.500      0.117      4.27  2.80e- 5\n11 seasons_Summer_x_temp               -1.21       0.249     -4.85  2.28e- 6\n12 seasons_Winter_x_temp               -0.650      0.307     -2.12  3.51e- 2\n13 temp_x_rainfall                     -0.107      0.0510    -2.09  3.78e- 2\n14 rainfall_poly_1                     -2.81       0.679     -4.14  4.85e- 5\n15 rainfall_poly_2                      1.22       0.373      3.28  1.21e- 3\n16 snowfall_poly_1                     -0.0667     0.353     -0.189 8.50e- 1\n17 snowfall_poly_2                     -0.308      0.333     -0.925 3.56e- 1\n18 temp_poly_1                         -7.58       7.12      -1.07  2.88e- 1\n19 temp_poly_2                         -3.93       1.86      -2.12  3.51e- 2\n20 hum_poly_1                          -6.40       2.47      -2.59  1.03e- 2\n21 hum_poly_2                          -0.389      0.597     -0.651 5.16e- 1\n22 wind_speed_poly_1                   -0.377      0.353     -1.07  2.87e- 1\n23 wind_speed_poly_2                   -0.338      0.325     -1.04  2.99e- 1\n24 vis_poly_1                           0.593      0.470      1.26  2.09e- 1\n25 vis_poly_2                          -0.302      0.319     -0.946 3.45e- 1\n26 dew_pt_poly_1                       20.1        8.20       2.45  1.52e- 2\n27 dew_pt_poly_2                        0.393      1.15       0.341 7.34e- 1\n28 sol_rad_poly_1                       4.96       0.593      8.36  5.51e-15\n29 sol_rad_poly_2                      -0.481      0.374     -1.29  2.00e- 1\n\n\nThe rmse on the test set for the best fit model is 0.344."
  }
]